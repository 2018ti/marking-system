<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <title>文本编辑页面</title>
    <link rel="stylesheet" type="text/css" href="css/bootstrap.css">
    <link rel="stylesheet" type="text/css" href="css/marking.css">

    <script type="text/javascript" src="js/JQuery/jquery.js"></script>
    <script type="text/javascript" src="js/bootstrap/bootstrap.min.js"></script>
    <link rel="stylesheet" type="text/css" href="css/article.css" />
    <style>
        .red {
            color: red;
        }
        
        .text {
            width: 100%;
            min-height: 120px;
            max-height: 300px;
            margin-left: auto;
            margin-right: auto;
            padding: 3px;
            outline: 0;
            border: 1px solid #a0b3d6;
            font-size: 20px;
            line-height: 24px;
            word-wrap: break-word;
            overflow-x: hidden;
            overflow-y: auto;
            border-color: rgba(82, 168, 236, 0.8);
            box-shadow: inset 0 1px 3px rgba(0, 0, 0, 0.1), 0 0 8px rgba(82, 168, 236, 0.6);
        }
    </style>
</head>

<body>
    <div class="container">
        <div id="div1">
            <img src="picture/bannerbg.png">
        </div>
        <div class="top">
            <div class="top-left">
                <a href="/user.html" class="top-art">个人中心</a>
            </div>
        </div>
        <div class="main">
            <!-- <div class="txt">
                <div id="text">wegwegew围观的地点在哪里</textarea>
                </div>
                <div class="operate">

                </div>
            </div> -->
            <div class="text" contenteditable="true" id="text">
            </div>
            <div class="form-group">
                <input type="button" value="保存修改" class="btn btn-primary btn-lg" style="margin-left:250px;" id="save">
            </div>
            <div class="row">
                <div class="col-lg-6">
                    <div class="list-group">
                        <div class="panel panel-default" style="width:500px;">
                            <div class="panel-heading" id="t">触发词</div>
                            <div class="panel-body" id="w">
                            </div>
                        </div>
                        <div class="panel panel-default" style="width:500px;">
                            <div class="panel-heading" id="t1">1</div>
                            <div class="panel-body" id="w1">

                            </div>
                        </div>
                        <div class="panel panel-default" style="width:500px;">
                            <div class="panel-heading" id="t2">2</div>
                            <div class="panel-body" id="w2">
                            </div>
                        </div>
                        <div class="panel panel-default" style="width:500px;">
                            <div class="panel-heading" id="t3">3</div>
                            <div class="panel-body" id="w3">
                            </div>
                        </div>
                        <div class="panel panel-default" style="width:500px;">
                            <div class="panel-heading" id="t4">4</div>
                            <div class="panel-body" id="w4">

                            </div>
                        </div>
                    </div>
                </div>
                <div class="col=lg-6">
                    <div class="list-group" style="margin-left:100px;">
                        <div class="btn-group">
                            <button type="button" class="btn btn-default" id="event1">会见会谈</button>
                            <button type="button" class="btn btn-default dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="caret"></span>
                        <span class="sr-only">Toggle Dropdown</span>
                    </button>
                            <ul class="dropdown-menu">
                                <li><button type="button" class="btn btn-default" id="event1_person1">参与方1</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-default" id="event1_person2">参与方2</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-default" id="event1_date">时间</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-default" id="event1_place">地点</button></li>
                            </ul>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-primary" id="event2">签署文件</button>
                            <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="caret"></span>
                        <span class="sr-only">Toggle Dropdown</span>
                    </button>
                            <ul class="dropdown-menu">
                                <li><button type="button" class="btn btn-primary" id="event2_person">签署方</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-primary" id="event2_document">文件</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-primary" id="event2_date">签署时间</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-primary" id="event2_place">签署地点</button></li>
                            </ul>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-success" id="event3">设施启动</button>
                            <button type="button" class="btn btn-success dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="caret"></span>
                        <span class="sr-only">Toggle Dropdown</span>
                    </button>
                            <ul class="dropdown-menu">
                                <li><button type="button" class="btn btn-success" id="event3_person">设施修建方</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-success" id="event3_name">设施名称</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-success" id="event3_date">启动时间</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-success" id="event3_place">设施地点</button></li>
                            </ul>
                        </div>
                        <div class="btn-group">
                            <button type="button" class="btn btn-info" id="event4">举行活动</button>
                            <button type="button" class="btn btn-info dropdown-toggle" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                        <span class="caret"></span>
                        <span class="sr-only">Toggle Dropdown</span>
                    </button>
                            <ul class="dropdown-menu">
                                <li><button type="button" class="btn btn-info" id="event4_person">举办方</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-info" id="event4_name">活动名称</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-info" id="event4_place">活动地点</button></li>
                                <li role="separator" class="divider"></li>
                                <li><button type="button" class="btn btn-info" id="event4_date">活动时间</button></li>
                            </ul>
                        </div>
                    </div>
                </div>
            </div>
        </div>
</body>
</script>
<script type="text/javascript">
    var markingId = getQueryString("markingId");

    function getQueryString(name) {
        var result = window.location.search.match(new RegExp("[\?\&]" + name + "=([^\&]+)", "i"));
        if (result == null || result.length < 1) {
            return "";
        }
        return result[1];
    }

    $(document).ready(function() {

        $.ajax({
            url: "/getTxtByMarkingId",
            method: "get",
            dataType: "json",
            data: {
                markingId: markingId,
            },
            //数据渲染到text并改变颜色
            success: function(data) {
                $("#text").text(data["content"]);
                $("#w").html(data['trigger']);
                $("#w1").html(data['marking1']);
                $("#w2").html(data['marking2']);
                $("#w3").html(data['marking3']);
                $("#w4").html(data['marking4']);
                if (data["eventType"] == '会见会谈') {
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['trigger'], '<span style="color: red;" id="trigger">' + data['trigger'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking1'], '<span style="color: orange;" id="participant1">' + data['marking1'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking2'], '<span style="color: green;" id="participant2">' + data['marking2'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking3'], '<span style="color: purple;" id="time">' + data['marking3'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking4'], '<span style="color: blue;" id="place">' + data['marking4'] + '</span>');
                    })
                    $("#t1").html('参与方1');
                    $("#t2").html('参与方2');
                    $("#t3").html('时间');
                    $("#t4").html('地点');
                    //---------------------------签署文件
                } else if (data["eventType"] == '签署文件') {
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['trigger'], '<span style="color: red;" id="trigger">' + data['trigger'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking1'], '<span style="color: orange;" id="signatory">' + data['marking1'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking2'], '<span style="color: purple;" id="file">' + data['marking2'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking3'], '<span style="color: green;" id="time">' + data['marking3'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking4'], '<span style="color: blue;" id="place">' + data['marking4'] + '</span>');
                    })
                    $("#t1").html('签署方');
                    $("#t2").html('文件');
                    $("#t3").html('签署时间');
                    $("#t4").html('签署地点');

                } else if (data["eventType"] == '设施启用') {
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['trigger'], '<span style="color: red;" id="trigger">' + data['trigger'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking1'], '<span style="color: green;" id="constructor">' + data['marking1'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking2'], '<span style="color: orange;" id="buildingName">' + data['marking2'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking3'], '<span style="color: blue;" id="time">' + data['marking3'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking4'], '<span style="color: purple;" id="place">' + data['marking4'] + '</span>');
                    })
                    $("#t1").html('设施修建方');
                    $("#t2").html('设施名称');
                    $("#t3").html('启动时间');
                    $("#t4").html('设施地点');
                } else {
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['trigger'], '<span style="color: red;" id="trigger">' + data['trigger'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking1'], '<span style="color: green;" id="holder">' + data['marking1'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking2'], '<span style="color: orange;" id="name">' + data['marking2'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking3'], '<span style="color: blue;" id="place">' + data['marking3'] + '</span>');
                    })
                    $('#text').html(function(i, oldHTML) {
                        return oldHTML.replace(data['marking4'], '<span style="color: purple;" id="time">' + data['marking4'] + '</span>');
                    })
                    $("#t1").html('举办方');
                    $("#t2").html('活动名称');
                    $("#t3").html('活动地点');
                    $("#t4").html('活动时间');
                }
            }
        })
    });
</script>

</html>